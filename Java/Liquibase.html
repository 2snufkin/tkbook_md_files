<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Documentation Site</title>
    <link rel="stylesheet" href="style.css">
</head>
<style>
    body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    height: 100vh;
}

.navbar {
    background-color: #333;
    color: white;
    padding: 10px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.app-name {
    font-size: 1.5em;
}

.folder-links {
    display: flex;
    gap: 10px;
}

.folder-link {
    color: white;
    text-decoration: none;
}

.folder-link:hover {
    text-decoration: underline;
}

.container {
    display: flex;
    flex: 1;
}

.sidebar {
    width: 200px;
    background-color: #1e90ff;
    padding: 10px;
    color: white;
    overflow-y: auto;
}

.content {
    flex: 1;
    padding: 20px;
    overflow-y: auto;
}

</style>
<body>
    <div class="navbar">
        <div class="app-name">Placeholder</div>
        <div class="folder-links">
            
                <a href="#" class="folder-link" data-folder="C:\Users\work\Documents\tkBook_md\Best Practice">C:\Users\work\Documents\tkBook_md\Best Practice</a>
            
                <a href="#" class="folder-link" data-folder="C:\Users\work\Documents\tkBook_md\Errors">C:\Users\work\Documents\tkBook_md\Errors</a>
            
                <a href="#" class="folder-link" data-folder="C:\Users\work\Documents\tkBook_md\Java">C:\Users\work\Documents\tkBook_md\Java</a>
            
                <a href="#" class="folder-link" data-folder="C:\Users\work\Documents\tkBook_md\Tumorotek">C:\Users\work\Documents\tkBook_md\Tumorotek</a>
            
        </div>
    </div>
    <div class="container">
        <div class="sidebar" id="sidebar"></div>
        <div class="content">
            <h1>Liquibase Overview</h1>
<p>Liquibase is an open-source database-independent library for tracking, managing, and applying database schema changes. It allows you to version control your database schema, making it easier to deploy.</p>
<h2>Configuring Liquibase</h2>
<p>To work with Liquibase and run Liquibase commands, you need to edit the <code>tumorotek-webapp/src/main/resources/liquibase/liquibase.properties</code> file. Update the following properties:
- <code>url</code>: the URL for tk database
- <code>username</code>: MySQL username
- <code>password</code>: MySQL password</p>
<h2>Resolving Commend Error</h2>
<p>If you encounter an error while running the update command like "Could not acquire change log lock. Currently locked by xxx since yyy," follow these steps:
1. Run this query to see the problem: 
    <code>sql
    SELECT * FROM DATABASECHANGELOGLOCK WHERE ID = 1;</code>
2. Release the lock by running: 
    <code>sql
    UPDATE DATABASECHANGELOGLOCK SET LOCKED = 0, LOCKGRANTED = NULL, LOCKEDBY = NULL WHERE ID = 1;</code></p>
<h2>How Liquibase Works</h2>
<h3>Changelog File</h3>
<p>Liquibase uses a changelog file (usually in XML, YAML, or SQL format) to define database changes.
The changelog file contains a set of changesets, each representing a specific database change.</p>
<h3>Changesets</h3>
<p>Changesets are units of change within the changelog file.
Each changeset describes a specific database change using a set of commands.</p>
<h3>Commands</h3>
<p>Liquibase commands define specific database operations such as creating a table, adding a column, or inserting data.
Common commands include <code>&lt;createTable&gt;</code>, <code>&lt;addColumn&gt;</code>, <code>&lt;modifyColumn&gt;</code>, <code>&lt;sql&gt;</code>, etc.</p>
<h3>Database Connection</h3>
<p>Liquibase requires information about the database connection to apply changes.
Connection details (URL, username, password) are usually specified in a properties file or directly in the changelog file.</p>
<h3>Execution</h3>
<p>Liquibase can be executed from the command line, integrated into build tools (Maven, Gradle), or used programmatically.
When Liquibase runs, it checks the database for its change history and applies pending changes.</p>
<h2>Setting up Liquibase Configuration</h2>
<ol>
<li><strong>Install Liquibase</strong>: Download it from the official website or use Maven or Gradle dependency management.</li>
<li><strong>Database Configuration</strong>: Configure your database connection details in either a properties file or directly in the changelog file.</li>
<li><strong>Changelog File</strong>: Create a changelog file to define your database changes.</li>
</ol>
<h2>Defining Datasource in Liquibase</h2>
<p>You can define the database connection information using either a properties file or directly in the changelog file:
1. <strong>Using Properties File</strong>:
   - Create a <code>liquibase.properties</code> file with your connection details.
   <code>properties
   url=jdbc:mysql://localhost:3306/dev_tumo?useSSL=false&amp;createDatabaseIfNotExist=true&amp;characterEncoding=UTF-8&amp;rewriteBatchedStatements=true&amp;serverTimezone=Europe/Paris
   username=your_username
   password=your_password</code>
2. <strong>Directly in Changelog File</strong>:
   - Define connection details within the changelog XML using attributes like <code>url</code>, <code>username</code>, and <code>password</code>.</p>
<h2>Using Liquibase in TK Project</h2>
<p>In TK project's pom.xml files:
- <strong>tumorotek-webapp</strong> plugin configuration sets up Liquibase execution during Maven build process.
- <strong>tumorotek-model</strong> ignores certain goals of Liquibasen based on version range.</p>
<h2>Force Rerun of Changeset</h2>
<p>If you need to force rerun of specific changeset due to configurations:
1. Identify Changeset: Find ID and AUTHOR of desired changeset.
2. Delete from DATABASECHANGELOG: Remove corresponding record using SQL DELETE statement.
3. Run Liquibse: After deletion, run Liquibse again for reapplication of changeset during Maven build process.</p>
<p>This is an overview; adjust processes based on your requirements and databases supported by Liquibae features like rollbacks and preconditions for effective management of database schema changes.</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('.folder-link').forEach(link => {
                link.addEventListener('click', function() {
                    const folder = this.getAttribute('data-folder');
                    fetchSidebarLinks(folder);
                });
            });
        });

        function fetchSidebarLinks(folder) {
            const sidebar = document.getElementById('sidebar');
            sidebar.innerHTML = '';
            fetch(`${folder}/index.html`).then(response => response.text()).then(data => {
                const parser = new DOMParser();
                const doc = parser.parseFromString(data, 'text/html');
                const links = doc.querySelectorAll('a.nav-link');
                links.forEach(link => {
                    sidebar.appendChild(link.cloneNode(true));
                });
            });
        }
    </script>
</body>
</html>